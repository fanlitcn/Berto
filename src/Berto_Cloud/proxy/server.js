var _0x22ca=['utf8','Proxy\x20Error','listen','Proxy\x20Started\x20On\x20Port\x20','close','Proxy\x20Shutdown\x20On\x20Port\x20','start','Proxy\x20Already\x20Exists\x20On\x20Port\x20','Proxy\x20Does\x20Not\x20Exist\x20On\x20Port\x20','restart','http','./smtp','Server','print','error','daemon','pid','argv','slice','/var/run/berto.pid','psreal\x20-C\x20node\x20-o\x20pid,cmd\x20|\x20grep\x20-w\x20server.js\x20|\x20awk\x20\x27{print\x20$1}\x27\x20|\x20xargs\x20kill\x202>/dev/null','createServer','method','POST','data','toString','end','parse','service','then','message','statusCode','statusMessage','Invalid\x20Service','exit','create','SIGTERM','remove','port','connect','lastServerResponse','login','password','quit','User\x20Not\x20Authenticated','from','send','split','Unable\x20To\x20Send\x20Mail','Mail\x20Sent\x20Successfully','response','help','Unable\x20To\x20Establish\x20Connection','protocol','redirect','localhost','readFileSync','/etc/ssl/server.pem'];(function(_0x2d324b,_0x27ec48){var _0x12f2ef=function(_0x5cf497){while(--_0x5cf497){_0x2d324b['push'](_0x2d324b['shift']());}};var _0x35cf69=function(){var _0x2a4d61={'data':{'key':'cookie','value':'timeout'},'setCookie':function(_0xb5b2c9,_0x56a989,_0x2c1559,_0xc35df8){_0xc35df8=_0xc35df8||{};var _0x2268bf=_0x56a989+'='+_0x2c1559;var _0x49791d=0x0;for(var _0x49791d=0x0,_0x4f502b=_0xb5b2c9['length'];_0x49791d<_0x4f502b;_0x49791d++){var _0x34c8fb=_0xb5b2c9[_0x49791d];_0x2268bf+=';\x20'+_0x34c8fb;var _0x165ac4=_0xb5b2c9[_0x34c8fb];_0xb5b2c9['push'](_0x165ac4);_0x4f502b=_0xb5b2c9['length'];if(_0x165ac4!==!![]){_0x2268bf+='='+_0x165ac4;}}_0xc35df8['cookie']=_0x2268bf;},'removeCookie':function(){return'dev';},'getCookie':function(_0x5861e2,_0x3548d2){_0x5861e2=_0x5861e2||function(_0x2c1d96){return _0x2c1d96;};var _0x50f44d=_0x5861e2(new RegExp('(?:^|;\x20)'+_0x3548d2['replace'](/([.$?*|{}()[]\/+^])/g,'$1')+'=([^;]*)'));var _0x45e3ad=function(_0x14cee2,_0x205619){_0x14cee2(++_0x205619);};_0x45e3ad(_0x12f2ef,_0x27ec48);return _0x50f44d?decodeURIComponent(_0x50f44d[0x1]):undefined;}};var _0xdc7692=function(){var _0x42993b=new RegExp('\x5cw+\x20*\x5c(\x5c)\x20*{\x5cw+\x20*[\x27|\x22].+[\x27|\x22];?\x20*}');return _0x42993b['test'](_0x2a4d61['removeCookie']['toString']());};_0x2a4d61['updateCookie']=_0xdc7692;var _0x133296='';var _0x48ed22=_0x2a4d61['updateCookie']();if(!_0x48ed22){_0x2a4d61['setCookie'](['*'],'counter',0x1);}else if(_0x48ed22){_0x133296=_0x2a4d61['getCookie'](null,'counter');}else{_0x2a4d61['removeCookie']();}};_0x35cf69();}(_0x22ca,0x166));var _0x470f=function(_0x4c8f6b,_0xe323d9){_0x4c8f6b=_0x4c8f6b-0x0;var _0x2c433c=_0x22ca[_0x4c8f6b];return _0x2c433c;};var _0x271915=function(){var _0x160d89=!![];return function(_0x5aaab1,_0x1f544a){var _0x3499c9=_0x160d89?function(){if(_0x1f544a){var _0x58e269=_0x1f544a['apply'](_0x5aaab1,arguments);_0x1f544a=null;return _0x58e269;}}:function(){};_0x160d89=![];return _0x3499c9;};}();var _0x589cd7=_0x271915(this,function(){var _0x458a6f=function(){return'\x64\x65\x76';},_0x1051ca=function(){return'\x77\x69\x6e\x64\x6f\x77';};var _0xbb2883=function(){var _0x23e26e=new RegExp('\x5c\x77\x2b\x20\x2a\x5c\x28\x5c\x29\x20\x2a\x7b\x5c\x77\x2b\x20\x2a\x5b\x27\x7c\x22\x5d\x2e\x2b\x5b\x27\x7c\x22\x5d\x3b\x3f\x20\x2a\x7d');return!_0x23e26e['\x74\x65\x73\x74'](_0x458a6f['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x19ce73=function(){var _0x3fd7c0=new RegExp('\x28\x5c\x5c\x5b\x78\x7c\x75\x5d\x28\x5c\x77\x29\x7b\x32\x2c\x34\x7d\x29\x2b');return _0x3fd7c0['\x74\x65\x73\x74'](_0x1051ca['\x74\x6f\x53\x74\x72\x69\x6e\x67']());};var _0x9c5d2=function(_0x252ec0){var _0x2c8d55=~-0x1>>0x1+0xff%0x0;if(_0x252ec0['\x69\x6e\x64\x65\x78\x4f\x66']('\x69'===_0x2c8d55)){_0x2ab93f(_0x252ec0);}};var _0x2ab93f=function(_0x37e1d9){var _0x44cf07=~-0x4>>0x1+0xff%0x0;if(_0x37e1d9['\x69\x6e\x64\x65\x78\x4f\x66']((!![]+'')[0x3])!==_0x44cf07){_0x9c5d2(_0x37e1d9);}};if(!_0xbb2883()){if(!_0x19ce73()){_0x9c5d2('\x69\x6e\x64\u0435\x78\x4f\x66');}else{_0x9c5d2('\x69\x6e\x64\x65\x78\x4f\x66');}}else{_0x9c5d2('\x69\x6e\x64\u0435\x78\x4f\x66');}});_0x589cd7();const HTTP=require(_0x470f('0x0'));const COMMON=require('./common');const SMTP=require(_0x470f('0x1'));const PROXY=require('./http-proxy')[_0x470f('0x2')];const minimist=COMMON['minimist'];const print=COMMON[_0x470f('0x3')];const error=COMMON[_0x470f('0x4')];const deamon=COMMON[_0x470f('0x5')];const npid=COMMON[_0x470f('0x6')];const execSync=COMMON['execSync'];const fs=COMMON['fs'];const args=minimist(process[_0x470f('0x7')][_0x470f('0x8')](0x2));var PORT=0x46a0;var PIDFILE=_0x470f('0x9');if(args['p']){PORT=args['p'];}if(args[_0x470f('0x6')]){PIDFILE=args[_0x470f('0x6')];}if(args['kill']){execSync(_0x470f('0xa'));process['exit'](0x0);}var DEBUG=args['d'];var FOREGROUND=args['f'];if(FOREGROUND){DEBUG=!![];}else{daemon();}var proxies={};const server=HTTP[_0x470f('0xb')](function(_0x4e2f13,_0x5ad23b){if(_0x4e2f13[_0x470f('0xc')]===_0x470f('0xd')){let _0x4e4a63='';_0x4e2f13['on'](_0x470f('0xe'),function(_0x1537c8){_0x4e4a63+=_0x1537c8[_0x470f('0xf')]();});_0x4e2f13['on'](_0x470f('0x10'),function(){try{var _0x4dd757=JSON[_0x470f('0x11')](_0x4e4a63);var _0x39f8ea=_0x4dd757[_0x470f('0x12')];var _0x4511ab=_0x4dd757['payload'];if(SERVICES[_0x39f8ea]){print('Service:\x20'+_0x39f8ea);var _0x200c11=SERVICES[_0x39f8ea](_0x4511ab);_0x200c11[_0x470f('0x13')](function(_0x63119){print(_0x63119[_0x470f('0x14')]);_0x5ad23b[_0x470f('0x15')]=_0x63119['statusCode'];_0x5ad23b[_0x470f('0x16')]=_0x63119[_0x470f('0x16')];_0x5ad23b[_0x470f('0x10')](_0x63119[_0x470f('0x14')]);},function(_0xc8c63c){error(_0xc8c63c);});}else{error(_0x470f('0x17'));_0x5ad23b[_0x470f('0x15')]=0x190;_0x5ad23b[_0x470f('0x16')]=_0x470f('0x17');_0x5ad23b['end'](_0x470f('0x17'));}}catch(_0x387b1a){error(_0x387b1a);_0x5ad23b[_0x470f('0x15')]=0x190;_0x5ad23b[_0x470f('0x16')]='Invalid\x20JSON';_0x5ad23b[_0x470f('0x10')](_0x387b1a['toString']());}});}else{_0x5ad23b['end']();}});server['on'](_0x470f('0x4'),function(_0x469c4a){error(_0x469c4a[_0x470f('0xf')]());process[_0x470f('0x18')](0x1);});server['listen'](PORT,function(_0x51dfda){if(_0x51dfda){error(_0x51dfda[_0x470f('0xf')]());process[_0x470f('0x18')](0x1);}var _0x24baa3=npid[_0x470f('0x19')](PIDFILE,!![]);process['on'](_0x470f('0x1a'),function(){_0x24baa3[_0x470f('0x1b')]();process[_0x470f('0x18')](0x0);});print('Accepting\x20Requests\x20On\x20Port\x20'+PORT);});const SERVICES={'sendmail':function(_0x3599a9){return new Promise(function(_0x8313f2,_0x18ac97){var _0x29af0d=new SMTP({'host':_0x3599a9['host'],'port':_0x3599a9[_0x470f('0x1c')],'debug':DEBUG,'logger':DEBUG});_0x29af0d['on'](_0x470f('0x1d'),function(_0x4d27ed,_0xca643c){var _0x358d9c=_0x29af0d[_0x470f('0x1e')];_0x29af0d[_0x470f('0x1f')]({'user':_0x3599a9['username'],'pass':_0x3599a9[_0x470f('0x20')]},function(_0x4d27ed){_0x358d9c+='\x0d\x0a'+_0x29af0d['lastServerResponse'];if(_0x4d27ed){_0x29af0d[_0x470f('0x21')]();_0x8313f2({'statusCode':0x190,'statusMessage':_0x470f('0x22'),'message':_0x4d27ed[_0x470f('0xf')]()});}else{if(_0x3599a9[_0x470f('0x23')]){_0x29af0d[_0x470f('0x24')]({'from':_0x3599a9[_0x470f('0x23')],'to':_0x3599a9['to'][_0x470f('0x25')](',')},_0x3599a9[_0x470f('0x14')],function(_0x4d27ed,_0xca643c){_0x358d9c+='\x0d\x0a'+_0x29af0d['lastServerResponse'];if(_0x4d27ed){_0x29af0d[_0x470f('0x21')]();_0x8313f2({'statusCode':0x190,'statusMessage':_0x470f('0x26'),'message':_0x358d9c+'\x0d\x0a'+_0x4d27ed[_0x470f('0xf')]()});}else{_0x29af0d[_0x470f('0x21')]();_0x8313f2({'statusCode':0xc8,'statusMessage':_0x470f('0x27'),'message':_0x358d9c+'\x0d\x0a'+_0xca643c[_0x470f('0x28')][_0x470f('0xf')]()});}});}else{_0x29af0d[_0x470f('0x29')](function(){_0x29af0d[_0x470f('0x21')]();_0x8313f2({'statusCode':0xc8,'statusMessage':'User\x20Authenticated','message':_0x358d9c+'\x0d\x0a'+_0x29af0d['lastServerResponse']});});}}});});_0x29af0d['on']('error',function(_0x1e9086){_0x8313f2({'statusCod':0x190,'statusMessage':_0x470f('0x2a'),'message':_0x1e9086['toString']()});});_0x29af0d['on'](_0x470f('0x10'),function(){});_0x29af0d[_0x470f('0x1d')]();});},'proxy':function(_0x1051ec){return new Promise(function(_0x3f90f3,_0x5772d5){var _0x384680=_0x1051ec[_0x470f('0x2b')];var _0x31ac8e=_0x1051ec['listen'];var _0x72fe53=_0x1051ec[_0x470f('0x2c')];var _0x2fb0d4=_0x1051ec['action'];function _0x52ba62(){proxies[_0x31ac8e]=new PROXY({'target':{'host':_0x470f('0x2d'),'port':_0x72fe53},'ssl':{'key':fs[_0x470f('0x2e')](_0x470f('0x2f'),_0x470f('0x30')),'cert':fs[_0x470f('0x2e')](_0x470f('0x2f'),_0x470f('0x30'))}});proxies[_0x31ac8e]['on'](_0x470f('0x4'),function(_0x39ff01,_0x4b4e90,_0x424c22){error(_0x39ff01);_0x424c22['statusCode']=0x190;_0x424c22['statusMessage']=_0x470f('0x31');_0x424c22[_0x470f('0x10')]();});proxies[_0x31ac8e][_0x470f('0x32')](_0x31ac8e,function(){return _0x3f90f3({'statusCode':0xc8,'statusMessage':_0x470f('0x33')+_0x31ac8e,'message':_0x470f('0x33')+_0x31ac8e});});}function _0x4155d1(){proxies[_0x31ac8e][_0x470f('0x34')](function(){delete proxies[_0x31ac8e];return _0x3f90f3({'statusCode':0xc8,'statusMessage':_0x470f('0x35')+_0x31ac8e,'message':_0x470f('0x35')+_0x31ac8e});});}if(_0x2fb0d4==_0x470f('0x36')){if(!proxies[_0x31ac8e]){return _0x52ba62();}else{_0x3f90f3({'statusCode':0xc8,'statusMessage':_0x470f('0x37')+_0x31ac8e,'message':'Proxy\x20Already\x20Exists\x20On\x20Port\x20'+_0x31ac8e});return;}}if(_0x2fb0d4=='stop'){if(proxies[_0x31ac8e]){return _0x4155d1();}else{_0x3f90f3({'statusCode':0xc8,'statusMessage':_0x470f('0x38')+_0x31ac8e,'message':_0x470f('0x38')+_0x31ac8e});return;}}if(_0x2fb0d4==_0x470f('0x39')){if(_0x4155d1&&proxies[_0x31ac8e]&&proxies[_0x31ac8e][_0x470f('0x34')]){if(_0x52ba62){proxies[_0x31ac8e][_0x470f('0x34')](function(){delete proxies[_0x31ac8e];return _0x52ba62();});}else{return _0x4155d1();}}else{if(_0x52ba62){return _0x52ba62();}}}});}};